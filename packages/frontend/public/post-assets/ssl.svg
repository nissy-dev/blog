<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
	xmlns="http://www.w3.org/2000/svg"
	xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="638px" preserveAspectRatio="none" style="width:647px;height:638px;" version="1.1" viewBox="0 0 647 638" width="647px" zoomAndPan="magnify">
	<defs>
		<filter height="300%" id="f216nmabytr78" width="300%" x="-1" y="-1">
			<feGaussianBlur result="blurOut" stdDeviation="2.0"/>
			<feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
			<feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/>
			<feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/>
		</filter>
	</defs>
	<g>
		<line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="173" x2="173" y1="40.2969" y2="595.0859"/>
		<line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="421" x2="421" y1="40.2969" y2="595.0859"/>
		<rect fill="#FEFECE" filter="url(#f216nmabytr78)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="51" x="146" y="5"/>
		<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="153" y="24.9951">client</text>
		<rect fill="#FEFECE" filter="url(#f216nmabytr78)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="51" x="146" y="594.0859"/>
		<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="153" y="614.0811">client</text>
		<rect fill="#FEFECE" filter="url(#f216nmabytr78)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="391" y="5"/>
		<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="398" y="24.9951">server</text>
		<rect fill="#FEFECE" filter="url(#f216nmabytr78)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="391" y="594.0859"/>
		<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="398" y="614.0811">server</text>
		<polygon fill="#A80036" points="409.5,67.4297,419.5,71.4297,409.5,75.4297,413.5,71.4297" style="stroke:#A80036;stroke-width:1.0;"/>
		<line style="stroke:#A80036;stroke-width:1.0;" x1="173.5" x2="415.5" y1="71.4297" y2="71.4297"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="180.5" y="66.3638">　1. client hello メッセージ</text>
		<path d="M426,84.4297 L426,154.4297 L626,154.4297 L626,94.4297 L616,84.4297 L426,84.4297 " fill="#FBFB77" filter="url(#f216nmabytr78)" style="stroke:#A80036;stroke-width:1.0;"/>
		<path d="M616,84.4297 L616,94.4297 L626,94.4297 L616,84.4297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="432" y="101.4966">-  サポートするTLSバージョン</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="432" y="116.6294">- サポートする暗号スイート</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="432" y="131.7622">- ランダムバイト列　</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="440" y="146.895">(クライアントランダム)</text>
		<polygon fill="#A80036" points="184.5,181.0938,174.5,185.0938,184.5,189.0938,180.5,185.0938" style="stroke:#A80036;stroke-width:1.0;"/>
		<line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="420.5" y1="185.0938" y2="185.0938"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="190.5" y="180.0278">　2. server hello メッセージ</text>
		<path d="M5,198.0938 L5,268.0938 L165,268.0938 L165,208.0938 L155,198.0938 L5,198.0938 " fill="#FBFB77" filter="url(#f216nmabytr78)" style="stroke:#A80036;stroke-width:1.0;"/>
		<path d="M155,198.0938 L155,208.0938 L165,208.0938 L155,198.0938 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="11" y="215.1606">- SSL証明書</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="11" y="230.2935">- 選択した暗号スイート</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="11" y="245.4263">- ランダムバイト列　</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="19" y="260.5591">(サーバーランダム)</text>
		<line style="stroke:#A80036;stroke-width:1.0;" x1="173.5" x2="215.5" y1="298.7578" y2="298.7578"/>
		<line style="stroke:#A80036;stroke-width:1.0;" x1="215.5" x2="215.5" y1="298.7578" y2="311.7578"/>
		<line style="stroke:#A80036;stroke-width:1.0;" x1="174.5" x2="215.5" y1="311.7578" y2="311.7578"/>
		<polygon fill="#A80036" points="184.5,307.7578,174.5,311.7578,184.5,315.7578,180.5,311.7578" style="stroke:#A80036;stroke-width:1.0;"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="180.5" y="293.6919">　3. server が本人であることの認証</text>
		<path d="M178,324.7578 L178,364.7578 L419,364.7578 L419,334.7578 L409,324.7578 L178,324.7578 " fill="#FBFB77" filter="url(#f216nmabytr78)" style="stroke:#A80036;stroke-width:1.0;"/>
		<path d="M409,324.7578 L409,334.7578 L419,334.7578 L409,324.7578 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="184" y="341.8247">認証局の公開鍵を使って、</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="184" y="356.9575">SSL証明書のデジタル署名を復号する</text>
		<polygon fill="#A80036" points="409.5,391.1563,419.5,395.1563,409.5,399.1563,413.5,395.1563" style="stroke:#A80036;stroke-width:1.0;"/>
		<line style="stroke:#A80036;stroke-width:1.0;" x1="173.5" x2="415.5" y1="395.1563" y2="395.1563"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="180.5" y="390.0903">　4. プリマスターシークレットの作成</text>
		<path d="M426,408.1563 L426,478.1563 L638,478.1563 L638,418.1563 L628,408.1563 L426,408.1563 " fill="#FBFB77" filter="url(#f216nmabytr78)" style="stroke:#A80036;stroke-width:1.0;"/>
		<path d="M628,408.1563 L628,418.1563 L638,418.1563 L628,408.1563 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="432" y="425.2231">- 暗号化されたランダムバイト列</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="432" y="440.356">- SSL証明書から取得した</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="440" y="455.4888">公開鍵を使って暗号化</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="432" y="470.6216">- サーバーは秘密鍵で復号</text>
		<polygon fill="#A80036" points="409.5,504.8203,419.5,508.8203,409.5,512.8203,413.5,508.8203" style="stroke:#A80036;stroke-width:1.0;"/>
		<line style="stroke:#A80036;stroke-width:1.0;" x1="173.5" x2="415.5" y1="508.8203" y2="508.8203"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="180.5" y="503.7544">5. 共通鍵の作成と確認</text>
		<polygon fill="#A80036" points="184.5,518.8203,174.5,522.8203,184.5,526.8203,180.5,522.8203" style="stroke:#A80036;stroke-width:1.0;"/>
		<line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="420.5" y1="522.8203" y2="522.8203"/>
		<path d="M135,535.8203 L135,575.8203 L455,575.8203 L455,545.8203 L445,535.8203 L135,535.8203 " fill="#FBFB77" filter="url(#f216nmabytr78)" style="stroke:#A80036;stroke-width:1.0;"/>
		<path d="M445,535.8203 L445,545.8203 L455,545.8203 L445,535.8203 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="141" y="552.8872">クライアントランダム、サーバーランダム、</text>
		<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="299" x="141" y="568.02">プリマスターシークレットを利用して共通鍵を作成</text>
		<!--MD5=[83b8c88065f5c35a3b7b669d05877616]
@startuml
client -> server: 1. client hello メッセージ
note right of server
-  サポートするTLSバージョン
- サポートする暗号スイート
- ランダムバイト列
  (クライアントランダム)
end note

server -> client: 2. server hello メッセージ
note left of client
- SSL証明書
- 選択した暗号スイート
- ランダムバイト列
  (サーバーランダム)
end note

client -> client: 3. server が本人であることの認証
note right of client
認証局の公開鍵を使って、
SSL証明書のデジタル署名を復号する
end note

client -> server: 4. プリマスターシークレットの作成
note right of server
- 暗号化されたランダムバイト列
- SSL証明書から取得した
  公開鍵を使って暗号化
- サーバーは秘密鍵で復号
end note

client -> server: 5. 共通鍵の作成と確認
server -> client:

note over client, server
クライアントランダム、サーバーランダム、
プリマスターシークレットを利用して共通鍵を作成
end note
@enduml

PlantUML version 1.2020.22(Sun Dec 06 09:36:27 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
-->
	</g>
</svg>
