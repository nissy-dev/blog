---
title: "Oxc はうまくいくのか？"
date: "2023-06-25T07:51:40.672Z"
description: "description"
tags: ["blog"]
---

最近、Boschen さんが開発している Oxc に注目しています。現時点では、parser がほぼ完成していて、linter や minifier のコア部分の実装に集中している段階です。

https://github.com/Boshen/oxc

社内で Oxc の近況を slack に投稿していたところ、「Oxc は Rome で話題になっていますか？」「Oxc はうまくいくと思いますか？」
と聞かれたことで Rome の現状や自分の開発のモチベーションを整理するいいきっかけになったので、個人ブログに残しておこうかなと思います。

## Rome と Oxc の違い

Rome と Oxc はどちらも linter、formatter、transpiler などを提供するつもりではあるので、ユーザーからみた違いは分かりにくいかなとは思います。現時点での大きな違いは、次の２点だと思っています。

- プロジェクトのスコープ
  - Rome: JS/TS に限らず JSON や CSS などに関するツールも提供を試みている
  - Oxc: JS/TS に関するツールにフォーカスしている
- 提供するツールの拡張性に対する考え方
  - Rome: 設定できるパラメータは極力減らし、良いデフォルト値を提供する
  - Oxc: ユーザーによる拡張や独自ツールの作成を前提とした API を設計する

Rome は、近年の Web 開発に必要なツールチェーンの設定の多さや複雑さを解消したいというモチベーションから始まったプロジェクトです。このため、Rome のスコープは広く、提供されるツールは非常に opinionated なものになっています。

一方で、Oxc はプロジェクトのゴールに次の観点を掲げている通り、非常に拡張性を意識していることがわかります。

> Provide the basic building blocks for creating your own tools by having good API designs

## Rome はうまくいくのか？

Oxc がうまくいくかどうかの話の前に、そもそも Rome について振り返ってみます。

結論から言うと、Rome の core contributor ではありますが、このまま開発していっても当初の掲げた目標を達成するのはかなり厳しいと思っています。npm の weekly download をみてもらえばわかりますが、昨年の 10 月のリリース以降はなかなかユーザーも増やせていません。

https://www.npmjs.com/package/rome

Web 開発に必要なツールを統一するという目標に関しては、開発体制の変化とライブラリの増加が大きな障壁になっていそうです。

開発体制が完全なボランティアベースになってしまったので、CSS や HTML などに関する開発に着手する余裕がないのが現状で、開発者が増えるようなコミュニティーの形成についても何もアクションをとれていないです。また、近年 Astro や Qwik などの独自のパーサーが必要なのフレームワークが公開されることが多く、これらの対応についても全く着手できていないです。

ユーザーへの導入が進んでない大きな原因としては、Rome が ESLint からの移行パスを提供できてない点が挙げられると思います。

ESLint は非常に大きなプラグインのコミュニティを持っていますが、Rome は linter に関するプラグインの仕組みを提供しておらず、プラグインの仕組みを提供するのも簡単ではありません。移行しやすいように JS でかけるような仕組みにすると SWC のプラグイン作成時に議論されていたパフォーマンスの問題が生じる可能性があります。[^1] 一方で、Rust でかけるようにすると既存のプラグインを全て書き直す必要があります。

[^1]:

実際に SWC は Rust でのプラグインの仕組みを提供しましたが、やはりコミュニティー主体でのプラグインの実装はあまり起きず、作者自身が結局多くのプラグインを実装することになっていたように見えます。[^2] Rome の場合には、実装した方が良い ESLint ルールの数が SWC の時の比ではないので、もし Rust での仕組みを提供したとしても移行の障壁は非常に高いことが予想されます。

[^2]: https://github.com/swc-project/swc/discussions/4768 を見る限り、多くのプラグインをコアメンバーが実装しているように見えます。

また、Rome は現在よく使われる ESLint のルールを中心に 150 以上のルールを実装していますが、それらが実際の ESLint のどのルールと対応し、どれほどカバーできているのかという情報にすぐにアクセスできない状況にもなっています。

次のような ESLint の設定がよく使われていると思うのですが、このような設定で導入されるルールの 9 割以上は Rome でも実装されていると思います。この点については、自分も次のメジャーバージョンが出た後にドキュメントを書こうかなとは思っています。

```js
module.exports = {
  parser: "@typescript-eslint/parser",
  plugins: ["react", "@typescript-eslint", "jsx-a11y", "import"],
  extends: [
    "eslint:recommended",
    "plugin:react/recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:jsx-a11y/recommended",
    "plugin:import/recommended",
    "prettier",
  ],
  ...
}
```

## Oxc はうまくいくのか？

このように元々のプロジェクトの勢いを失っているように見える Rome とは対象的に、Oxc の開発は非常に活発です。Oxc はうまくいくのでしょうか？

まず、Oxc はスコープを JS/TS に絞っているので、複数言語や複数フレームワークを

## 自分はどうしていくのか
